gj.draggable={plugins:{}},gj.draggable.config={base:{handle:void 0,vertical:!0,horizontal:!0,containment:void 0}},gj.draggable.methods={init:function(a){var b,c,d=this.element;return this.type="draggable",gj.widget.prototype.initJS.call(this,a),c=this.getConfig(),d.setAttribute("data-gj-draggable","true"),b=gj.draggable.methods.getHandleElement(d,c),b.addEventListener("mousedown",gj.draggable.methods.createDownHandle(this,d,c)),b.addEventListener("touchstart",gj.draggable.methods.createDownHandle(this,d,c)),gj.documentManager.subscribeForEvent("mouseup",c.guid,gj.draggable.methods.createUpHandler(this,d,c)),gj.documentManager.subscribeForEvent("touchend",c.guid,gj.draggable.methods.createUpHandler(this,d,c)),gj.documentManager.subscribeForEvent("touchcancel",c.guid,gj.draggable.methods.createUpHandler(this,d,c)),this},createDownHandle:function(a,b,c){return function(d){var e=gj.core.position(b);b.style.top=e.top+"px",b.style.left=e.left+"px",b.style.position="fixed",b.setAttribute("data-gj-draggable-dragging",!0),b.removeAttribute("data-gj-draggable-x"),b.removeAttribute("data-gj-draggable-y"),gj.documentManager.subscribeForEvent("touchmove",c.guid,gj.draggable.methods.createMoveHandler(a,b,c)),gj.documentManager.subscribeForEvent("mousemove",c.guid,gj.draggable.methods.createMoveHandler(a,b,c))}},getHandleElement:function(a,b){return b.handle?b.handle:a},createUpHandler:function(a,b,c){return function(d){"true"===b.getAttribute("data-gj-draggable-dragging")&&(b.setAttribute("data-gj-draggable-dragging",!1),gj.documentManager.unsubscribeForEvent("mousemove",c.guid),gj.documentManager.unsubscribeForEvent("touchmove",c.guid),gj.draggable.events.stop(b,{x:a.mouseX(d),y:a.mouseY(d)}))}},createMoveHandler:function(a,b,c){return function(d){var e,f,g,h,i,j;"true"===b.getAttribute("data-gj-draggable-dragging")&&(e=Math.round(a.mouseX(d)),f=Math.round(a.mouseY(d)),i=b.getAttribute("data-gj-draggable-x"),j=b.getAttribute("data-gj-draggable-y"),i&&j?(g=c.horizontal?e-parseInt(i,10):0,h=c.vertical?f-parseInt(j,10):0,gj.draggable.methods.move(b,c,g,h,e,f)):gj.draggable.events.start(b,e,f),b.setAttribute("data-gj-draggable-x",e),b.setAttribute("data-gj-draggable-y",f))}},move:function(a,b,c,d,e,f){var g,h,i,j=gj.core.position(a),k=j.top+d,l=j.left+c;b.containment&&(g=gj.core.position(b.containment),h=g.top+gj.core.height(b.containment)-gj.core.height(a),i=g.left+gj.core.width(b.containment)-gj.core.width(a),k>g.top&&k<h?(g.top>=f||g.bottom<=f)&&(k=j.top):k=k<=g.top?g.top+1:h-1,l>g.left&&l<i?(g.left>=e||g.right<=e)&&(l=j.left):l=l<=g.left?g.left+1:i-1),!1!==gj.draggable.events.drag(a,l,k,e,f)&&(a.style.top=k+"px",a.style.left=l+"px")},destroy:function(a){if("true"===a.getAttribute("data-gj-draggable")){gj.documentManager.unsubscribeForEvent("mouseup",data.guid),gijgoStorage.remove(a,a.getAttribute("data-type")),a.removeAttribute("data-gj-guid"),a.removeAttribute("data-gj-type"),a.removeAttribute("data-gj-draggable"),a.removeAttribute("data-gj-draggable-x"),a.removeAttribute("data-gj-draggable-y"),a.removeAttribute("data-gj-draggable-dragging"),a.style.top="",a.style.left="",a.style.position="",a.removeEventListener("drag"),a.removeEventListener("start"),a.removeEventListener("stop");var b=gj.draggable.methods.getHandleElement(a,data);b.removeEventListener("mousedown"),b.removeEventListener("touchstart")}return a}},gj.draggable.events={drag:function(a,b,c,d,e){var f=new CustomEvent("drag",{detail:{newPosition:{left:b,top:c},mousePosition:{x:d,y:e}}});return a.dispatchEvent(f)},start:function(a,b,c){return a.dispatchEvent(new CustomEvent("start",{x:b,y:c}))},stop:function(a,b){return a.dispatchEvent(new CustomEvent("stop",b))}},GijgoDraggable=function(a,b){var c=this,d=gj.draggable.methods;return c.element=a,c.destroy=function(){return d.destroy(this)},"true"!==a.getAttribute("data-gj-draggable")&&d.init.call(c,b),c},GijgoDraggable.prototype=new gj.widget,GijgoDraggable.constructor=GijgoDraggable,"undefined"!=typeof jQuery&&function(a){a.fn.draggable=function(a){var b;if(this&&this.length){if("object"!=typeof a&&a){if(b=new GijgoDraggable(this[0],null),b[a])return b[a].apply(this[0],Array.prototype.slice.call(arguments,1));throw"Method "+a+" does not exist."}return new GijgoDraggable(this[0],a)}}}(jQuery);