gj.tree={plugins:{}},gj.tree.config={base:{params:{},autoLoad:!0,selectionType:"single",cascadeSelection:!1,dataSource:void 0,primaryKey:void 0,textField:"text",childrenField:"children",hasChildrenField:"hasChildren",imageCssClassField:"imageCssClass",imageUrlField:"imageUrl",imageHtmlField:"imageHtml",disabledField:"disabled",width:void 0,border:!1,uiLibrary:"materialdesign",iconsLibrary:"materialicons",autoGenId:1,autoGenFieldName:"autoId_b5497cc5-7ef3-49f5-a7dc-4a932e1aee4a",indentation:24,style:{wrapper:"gj-unselectable",list:"gj-list gj-list-md",item:void 0,active:"gj-list-md-active",leafIcon:void 0,border:"gj-tree-md-border"},icons:{expand:'<i class="gj-icon chevron-right" />',collapse:'<i class="gj-icon chevron-down" />'}},bootstrap:{style:{wrapper:"gj-unselectable gj-tree-bootstrap-3",list:"gj-list gj-list-bootstrap list-group",item:"list-group-item",active:"active",border:"gj-tree-bootstrap-border"},iconsLibrary:"glyphicons"},bootstrap4:{style:{wrapper:"gj-unselectable gj-tree-bootstrap-4",list:"gj-list gj-list-bootstrap",item:"list-group-item",active:"active",border:"gj-tree-bootstrap-border"},icons:{expand:'<i class="gj-icon plus" />',collapse:'<i class="gj-icon minus" />'}},materialicons:{style:{expander:"gj-tree-material-icons-expander"}},fontawesome:{style:{expander:"gj-tree-font-awesome-expander"},icons:{expand:'<i class="fa fa-plus" aria-hidden="true"></i>',collapse:'<i class="fa fa-minus" aria-hidden="true"></i>'}},glyphicons:{style:{expander:"gj-tree-glyphicons-expander"},icons:{expand:'<span class="glyphicon glyphicon-plus" />',collapse:'<span class="glyphicon glyphicon-minus" />'}}},gj.tree.events={initialized:function(e){e.triggerHandler("initialized")},dataBinding:function(e){e.triggerHandler("dataBinding")},dataBound:function(e){e.triggerHandler("dataBound")},select:function(e,t,a){return e.triggerHandler("select",[t,a])},unselect:function(e,t,a){return e.triggerHandler("unselect",[t,a])},expand:function(e,t,a){return e.triggerHandler("expand",[t,a])},collapse:function(e,t,a){return e.triggerHandler("collapse",[t,a])},enable:function(e,t){return e.triggerHandler("enable",[t])},disable:function(e,t){return e.triggerHandler("disable",[t])},destroying:function(e){return e.triggerHandler("destroying")},nodeDataBound:function(e,t,a,r){return e.triggerHandler("nodeDataBound",[t,a,r])}},gj.tree.methods={init:function(e){return this.type="tree",gj.widget.prototype.init.call(this,e),gj.tree.methods.initialize.call(this),this.data("autoLoad")&&this.reload(),this},initialize:function(){var e=this.data(),t=$('<ul class="'+e.style.list+'"/>');this.empty().addClass(e.style.wrapper).append(t),e.width&&this.width(e.width),e.border&&this.addClass(e.style.border),gj.tree.events.initialized(this)},useHtmlDataSource:function(e,t){t.dataSource=[]},render:function(e,t){var a;return t&&("string"==typeof t&&JSON&&(t=JSON.parse(t)),(a=e.data()).records=t,a.primaryKey||gj.tree.methods.genAutoId(a,a.records),gj.tree.methods.loadData(e)),e},filter:function(e){return e.data().dataSource},genAutoId:function(e,t){for(var a=0;a<t.length;a++)t[a][e.autoGenFieldName]=e.autoGenId++,t[a][e.childrenField]&&t[a][e.childrenField].length&&gj.tree.methods.genAutoId(e,t[a][e.childrenField])},loadData:function(e){var t,a=e.data("records"),r=e.children("ul");for(gj.tree.events.dataBinding(e),r.off().empty(),t=0;t<a.length;t++)gj.tree.methods.appendNode(e,r,a[t],1);gj.tree.events.dataBound(e)},appendNode:function(e,t,a,r,n){var d,i,l,o=e.data(),s=o.primaryKey?a[o.primaryKey]:a[o.autoGenFieldName],s=$('<li data-id="'+s+'" data-role="node" />').addClass(o.style.item);if($wrapper=$('<div data-role="wrapper" />'),$expander=$('<span data-role="expander" data-mode="close"></span>').addClass(o.style.expander),$display=$('<span data-role="display">'+a[o.textField]+"</span>"),hasChildren=void 0!==a[o.hasChildrenField]&&"true"===a[o.hasChildrenField].toString().toLowerCase(),disabled=void 0!==a[o.disabledField]&&"true"===a[o.disabledField].toString().toLowerCase(),o.indentation&&$wrapper.append($('<span data-role="spacer">').css("width",o.indentation*(r-1)+"px")),disabled?gj.tree.methods.disableNode(e,s):($expander.on("click",gj.tree.methods.expanderClickHandler(e)),$display.on("click",gj.tree.methods.displayClickHandler(e))),$wrapper.append($expander),$wrapper.append($display),s.append($wrapper),n?t.find("li:eq("+(n-1)+")").before(s):t.append(s),o.imageCssClassField&&a[o.imageCssClassField]?(l=$('<span data-role="image"><span class="'+a[o.imageCssClassField]+'"></span></span>')).insertBefore($display):o.imageUrlField&&a[o.imageUrlField]?((l=$('<span data-role="image"></span>')).insertBefore($display),(n=$('<img src="'+a[o.imageUrlField]+'"></img>')).attr("width",l.width()).attr("height",l.height()),l.append(n)):o.imageHtmlField&&a[o.imageHtmlField]&&(l=$('<span data-role="image">'+a[o.imageHtmlField]+"</span>")).insertBefore($display),a[o.childrenField]&&a[o.childrenField].length||hasChildren){if($expander.empty().append(o.icons.expand),i=$("<ul />").addClass(o.style.list).addClass("gj-hidden"),s.append(i),a[o.childrenField]&&a[o.childrenField].length)for(d=0;d<a[o.childrenField].length;d++)gj.tree.methods.appendNode(e,i,a[o.childrenField][d],r+1)}else o.style.leafIcon?$expander.addClass(o.style.leafIcon):$expander.html("&nbsp;");gj.tree.events.nodeDataBound(e,s,a.id,a)},expanderClickHandler:function(r){return function(e){var t=$(this),a=t.closest("li");"close"===t.attr("data-mode")?r.expand(a):r.collapse(a)}},expand:function(e,t,a){var r,n,d=t.find('>[data-role="wrapper"]>[data-role="expander"]'),i=e.data(),l=t.attr("data-id"),o=t.children("ul");if(!1!==gj.tree.events.expand(e,t,l)&&o&&o.length&&(o.show(),d.attr("data-mode","open"),d.empty().append(i.icons.collapse),a))for(r=t.find("ul>li"),n=0;n<r.length;n++)gj.tree.methods.expand(e,$(r[n]),a);return e},collapse:function(e,t,a){var r,n,d=t.find('>[data-role="wrapper"]>[data-role="expander"]'),i=e.data(),l=t.attr("data-id"),o=t.children("ul");if(!1!==gj.tree.events.collapse(e,t,l)&&o&&o.length&&(o.hide(),d.attr("data-mode","close"),d.empty().append(i.icons.expand),a))for(r=t.find('ul > li:has(span[data-mode="open"])'),n=0;n<r.length;n++)gj.tree.methods.collapse(e,$(r[n]),a);return e},expandAll:function(e){for(var t=e.find("ul>li"),a=0;a<t.length;a++)gj.tree.methods.expand(e,$(t[a]),!0);return e},collapseAll:function(e){for(var t=e.find('ul > li:has(span[data-mode="open"])'),a=0;a<t.length;a++)gj.tree.methods.collapse(e,$(t[a]),!0);return e},displayClickHandler:function(r){return function(e){var t=$(this).closest("li"),a=r.data().cascadeSelection;"true"===t.attr("data-selected")?gj.tree.methods.unselect(r,t,a):("single"===r.data("selectionType")&&gj.tree.methods.unselectAll(r),gj.tree.methods.select(r,t,a))}},selectAll:function(e){for(var t=e.find("ul>li"),a=0;a<t.length;a++)gj.tree.methods.select(e,$(t[a]),!0);return e},select:function(e,t,a){var r,n,d=e.data();if("true"!==t.attr("data-selected")&&!1!==gj.tree.events.select(e,t,t.attr("data-id"))&&(t.addClass(d.style.active).attr("data-selected","true"),a))for(n=t.find("ul>li"),r=0;r<n.length;r++)gj.tree.methods.select(e,$(n[r]),a)},unselectAll:function(e){for(var t=e.find("ul>li"),a=0;a<t.length;a++)gj.tree.methods.unselect(e,$(t[a]),!0);return e},unselect:function(e,t,a){var r,n;e.data();if("true"===t.attr("data-selected")&&!1!==gj.tree.events.unselect(e,t,t.attr("data-id"))&&(t.removeClass(e.data().style.active).removeAttr("data-selected"),a))for(n=t.find("ul>li"),r=0;r<n.length;r++)gj.tree.methods.unselect(e,$(n[r]),a)},getSelections:function(e){var t,a,r=[],n=e.children("li");if(n&&n.length)for(t=0;t<n.length;t++)"true"===(a=$(n[t])).attr("data-selected")?r.push(a.attr("data-id")):a.has("ul")&&(a=gj.tree.methods.getSelections(a.children("ul"))).length&&(r=r.concat(a));return r},getDataById:function(e,t,a){for(var r=e.data(),n=void 0,d=0;d<a.length;d++){if(r.primaryKey&&a[d][r.primaryKey]==t){n=a[d];break}if(a[d][r.autoGenFieldName]==t){n=a[d];break}if(a[d][r.childrenField]&&a[d][r.childrenField].length&&(n=gj.tree.methods.getDataById(e,t,a[d][r.childrenField])))break}return n},getDataByText:function(e,t,a){for(var r=void 0,n=e.data(),d=0;d<a.length;d++){if(t===a[d][n.textField]){r=a[d];break}if(a[d][n.childrenField]&&a[d][n.childrenField].length&&(r=gj.tree.methods.getDataByText(e,t,a[d][n.childrenField])))break}return r},getNodeById:function(e,t){var a,r,n=void 0,d=e.children("li");if(d&&d.length)for(a=0;a<d.length;a++){if(t==(r=$(d[a])).attr("data-id")){n=r;break}if(r.has("ul")&&(n=gj.tree.methods.getNodeById(r.children("ul"),t)))break}return n},getNodeByText:function(e,t){var a,r,n=void 0,d=e.children("li");if(d&&d.length)for(a=0;a<d.length;a++){if(t===(r=$(d[a])).find('>[data-role="wrapper"]>[data-role="display"]').text()){n=r;break}if(r.has("ul")&&(n=gj.tree.methods.getNodeByText(r.children("ul"),t)))break}return n},addNode:function(e,t,a,r){var n,d=e.data();return(a&&a.length?("li"===a[0].tagName.toLowerCase()&&(0===a.children("ul").length&&(a.find('[data-role="expander"]').empty().append(d.icons.collapse),a.append($("<ul />").addClass(d.style.list))),a=a.children("ul")),(n=e.getDataById(a.parent().data("id")))[d.childrenField]||(n[d.childrenField]=[]),n[d.childrenField]):(a=e.children("ul"),e.data("records"))).push(t),n=a.parentsUntil('[data-type="tree"]',"ul").length+1,d.primaryKey||gj.tree.methods.genAutoId(d,[t]),gj.tree.methods.appendNode(e,a,t,n,r),e},remove:function(e,t){return gj.tree.methods.removeDataById(e,t.attr("data-id"),e.data("records")),t.remove(),e},removeDataById:function(e,t,a){for(var r=e.data(),n=0;n<a.length;n++){if(r.primaryKey&&a[n][r.primaryKey]==t){a.splice(n,1);break}if(a[n][r.autoGenFieldName]==t){a.splice(n,1);break}a[n][r.childrenField]&&a[n][r.childrenField].length&&gj.tree.methods.removeDataById(e,t,a[n][r.childrenField])}},update:function(e,t,a){var r=e.data(),n=e.getNodeById(t);e.getDataById(t);return n.find('>[data-role="wrapper"]>[data-role="display"]').html(a[r.textField]),gj.tree.events.nodeDataBound(e,n,t,a),e},getChildren:function(e,t,a){for(var r=[],n=(a=void 0===a||a)?t.find("ul li"):t.find(">ul>li"),d=0;d<n.length;d++)r.push($(n[d]).data("id"));return r},enableAll:function(e){for(var t=e.find("ul>li"),a=0;a<t.length;a++)gj.tree.methods.enableNode(e,$(t[a]),!0);return e},enableNode:function(e,t,a){var r,n,d=t.find('>[data-role="wrapper"]>[data-role="expander"]'),i=t.find('>[data-role="wrapper"]>[data-role="display"]'),a=void 0===a||a;if(t.removeClass("disabled"),d.on("click",gj.tree.methods.expanderClickHandler(e)),i.on("click",gj.tree.methods.displayClickHandler(e)),gj.tree.events.enable(e,t),a)for(n=t.find("ul>li"),r=0;r<n.length;r++)gj.tree.methods.enableNode(e,$(n[r]),a)},disableAll:function(e){for(var t=e.find("ul>li"),a=0;a<t.length;a++)gj.tree.methods.disableNode(e,$(t[a]),!0);return e},disableNode:function(e,t,a){var r,n,d=t.find('>[data-role="wrapper"]>[data-role="expander"]'),i=t.find('>[data-role="wrapper"]>[data-role="display"]'),a=void 0===a||a;if(t.addClass("disabled"),d.off("click"),i.off("click"),gj.tree.events.disable(e,t),a)for(n=t.find("ul>li"),r=0;r<n.length;r++)gj.tree.methods.disableNode(e,$(n[r]),a)},destroy:function(e){return e.data()&&(gj.tree.events.destroying(e),e.xhr&&e.xhr.abort(),e.off(),e.removeData(),e.removeAttr("data-type"),e.removeClass().empty()),e},pathFinder:function(e,t,a,r){for(var n=!1,d=0;d<t.length;d++){if(t[d].id==a){n=!0;break}if(gj.tree.methods.pathFinder(e,t[d][e.childrenField],a,r)){r.push(t[d].data[e.textField]),n=!0;break}}return n}},(GijgoTree=function(e,t){var a=this,r=gj.datepicker.methods;return a.element=e,a.reload=function(e){return gj.widget.prototype.reload.call(this,e)},a.render=function(e){return r.render(this,e)},a.addNode=function(e,t,a){return r.addNode(this,e,t,a)},a.removeNode=function(e){return r.remove(this,e)},a.updateNode=function(e,t){return r.update(this,e,t)},a.destroy=function(){return r.destroy(this)},a.expand=function(e,t){return r.expand(this,e,t)},a.collapse=function(e,t){return r.collapse(this,e,t)},a.expandAll=function(){return r.expandAll(this)},a.collapseAll=function(){return r.collapseAll(this)},a.getDataById=function(e){return r.getDataById(this,e,this.data("records"))},a.getDataByText=function(e){return r.getDataByText(this,e,this.data("records"))},a.getNodeById=function(e){return r.getNodeById(this.children("ul"),e)},a.getNodeByText=function(e){return r.getNodeByText(this.children("ul"),e)},a.getAll=function(){return this.data("records")},a.select=function(e){return r.select(this,e)},a.unselect=function(e){return r.unselect(this,e)},a.selectAll=function(){return r.selectAll(this)},a.unselectAll=function(){return r.unselectAll(this)},a.getSelections=function(){return r.getSelections(this.children("ul"))},a.getChildren=function(e,t){return r.getChildren(this,e,t)},a.parents=function(e){var t=[],a=this.data();return r.pathFinder(a,a.records,e,t),t.reverse()},a.enable=function(e,t){return r.enableNode(this,e,t)},a.enableAll=function(){return r.enableAll(this)},a.disable=function(e,t){return r.disableNode(this,e,t)},a.disableAll=function(){return r.disableAll(this)},"tree"!==e.attr("data-type")&&r.init.call(a,t),a}).prototype=new gj.widget,GijgoTree.constructor=gj.tree.widget,"undefined"!=typeof jQuery&&(jQuery.fn.tree=function(e){var t;if(this&&this.length){if("object"!=typeof e&&e){if((t=new GijgoTree(this,null))[e])return t[e].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+e+" does not exist."}return new GijgoTree(this,e)}}),gj.tree.plugins.checkboxes={config:{base:{checkboxes:void 0,checkedField:"checked",cascadeCheck:!0}},private:{dataBound:function(e){e.data("cascadeCheck")&&(e=e.find('li[data-role="node"]'),$.each(e,function(){var e=$(this),t=e.find('[data-role="checkbox"] input[type="checkbox"]').checkbox("state");"checked"===t&&(gj.tree.plugins.checkboxes.private.updateChildrenState(e,t),gj.tree.plugins.checkboxes.private.updateParentState(e,t))}))},nodeDataBound:function(a,r,e,n){var d,t,i,l,o;0===r.find('> [data-role="wrapper"] > [data-role="checkbox"]').length&&(d=a.data(),t=r.find('> [data-role="wrapper"] > [data-role="expander"]'),i=$('<input type="checkbox"/>'),l=$('<span data-role="checkbox"></span>').append(i),o=void 0!==n[d.disabledField]&&"true"===n[d.disabledField].toString().toLowerCase(),i=i.checkbox({uiLibrary:d.uiLibrary,iconsLibrary:d.iconsLibrary,change:function(e,t){gj.tree.plugins.checkboxes.events.checkboxChange(a,r,n,i.state())}}),o&&i.prop("disabled",!0),n[d.checkedField]&&i.state("checked"),i.on("click",function(e){var t=i.closest("li"),a=i.state();d.cascadeCheck&&(gj.tree.plugins.checkboxes.private.updateChildrenState(t,a),gj.tree.plugins.checkboxes.private.updateParentState(t,a))}),t.after(l))},updateParentState:function(e,t){var a,r,n,d=e.parent("ul").parent("li");1===d.length&&(a=e.parent("ul").parent("li").find('> [data-role="wrapper"] > [data-role="checkbox"] input[type="checkbox"]'),e=e.siblings().find('> [data-role="wrapper"] > span[data-role="checkbox"] input[type="checkbox"]'),r="checked"===t,n="unchecked"===t,t="indeterminate",$.each(e,function(){var e=$(this).checkbox("state");r&&"checked"!==e&&(r=!1),n&&"unchecked"!==e&&(n=!1)}),r&&!n&&(t="checked"),!r&&n&&(t="unchecked"),a.checkbox("state",t),gj.tree.plugins.checkboxes.private.updateParentState(d,a.checkbox("state")))},updateChildrenState:function(e,t){e=e.find('ul li [data-role="wrapper"] [data-role="checkbox"] input[type="checkbox"]');0<e.length&&$.each(e,function(){$(this).checkbox("state",t)})},update:function(e,t,a){var r=t.find('[data-role="checkbox"] input[type="checkbox"]').first();$(r).checkbox("state",a),e.data().cascadeCheck&&(gj.tree.plugins.checkboxes.private.updateChildrenState(t,a),gj.tree.plugins.checkboxes.private.updateParentState(t,a))}},public:{getCheckedNodes:function(){var t=[],e=this.find('li [data-role="checkbox"] input[type="checkbox"]');return $.each(e,function(){var e=$(this);"checked"===e.checkbox("state")&&t.push(e.closest("li").data("id"))}),t},checkAll:function(){var e=this.find('li [data-role="checkbox"] input[type="checkbox"]');return $.each(e,function(){$(this).checkbox("state","checked")}),this},uncheckAll:function(){var e=this.find('li [data-role="checkbox"] input[type="checkbox"]');return $.each(e,function(){$(this).checkbox("state","unchecked")}),this},check:function(e){return gj.tree.plugins.checkboxes.private.update(this,e,"checked"),this},uncheck:function(e){return gj.tree.plugins.checkboxes.private.update(this,e,"unchecked"),this}},events:{checkboxChange:function(e,t,a,r){return e.triggerHandler("checkboxChange",[t,a,r])}},configure:function(n){n.data("checkboxes")&&gj.checkbox&&($.extend(!0,n,gj.tree.plugins.checkboxes.public),n.on("nodeDataBound",function(e,t,a,r){gj.tree.plugins.checkboxes.private.nodeDataBound(n,t,a,r)}),n.on("dataBound",function(){gj.tree.plugins.checkboxes.private.dataBound(n)}),n.on("enable",function(e,t){t.find('>[data-role="wrapper"]>[data-role="checkbox"] input[type="checkbox"]').prop("disabled",!1)}),n.on("disable",function(e,t){t.find('>[data-role="wrapper"]>[data-role="checkbox"] input[type="checkbox"]').prop("disabled",!0)}))}},gj.tree.plugins.dragAndDrop={config:{base:{dragAndDrop:void 0,style:{dragEl:"gj-tree-drag-el gj-tree-md-drag-el",dropAsChildIcon:"gj-cursor-pointer gj-icon plus",dropAbove:"gj-tree-drop-above",dropBelow:"gj-tree-drop-below"}},bootstrap:{style:{dragEl:"gj-tree-drag-el gj-tree-bootstrap-drag-el",dropAsChildIcon:"glyphicon glyphicon-plus",dropAbove:"drop-above",dropBelow:"drop-below"}},bootstrap4:{style:{dragEl:"gj-tree-drag-el gj-tree-bootstrap-drag-el",dropAsChildIcon:"gj-cursor-pointer gj-icon plus",dropAbove:"drop-above",dropBelow:"drop-below"}}},private:{nodeDataBound:function(e,t){var a=t.children('[data-role="wrapper"]'),r=t.find('>[data-role="wrapper"]>[data-role="display"]');a.length&&r.length&&(r.on("mousedown",gj.tree.plugins.dragAndDrop.private.createNodeMouseDownHandler(e)),r.on("mousemove",gj.tree.plugins.dragAndDrop.private.createNodeMouseMoveHandler(e,t,r)),r.on("mouseup",gj.tree.plugins.dragAndDrop.private.createNodeMouseUpHandler(e)))},createNodeMouseDownHandler:function(t){return function(e){t.data("dragReady",!0)}},createNodeMouseUpHandler:function(t){return function(e){t.data("dragReady",!1)}},createNodeMouseMoveHandler:function(d,i,l){return function(e){var t,a,r,n;d.data("dragReady")&&(a=d.data(),d.data("dragReady",!1),t=l.clone().wrap('<div data-role="wrapper"/>').closest("div").wrap('<li class="'+a.style.item+'" />').closest("li").wrap('<ul class="'+a.style.list+'" />').closest("ul"),$("body").append(t),t.attr("data-role","draggable-clone").addClass("gj-unselectable").addClass(a.style.dragEl),t.find('[data-role="wrapper"]').prepend('<span data-role="indicator" />'),t.draggable({drag:gj.tree.plugins.dragAndDrop.private.createDragHandler(d,i,l),stop:gj.tree.plugins.dragAndDrop.private.createDragStopHandler(d,i,l)}),a=l.parent(),r=l.offset().top,r-=parseInt(a.css("border-top-width"))+parseInt(a.css("margin-top"))+parseInt(a.css("padding-top")),n=l.offset().left,n=(n-=parseInt(a.css("border-left-width"))+parseInt(a.css("margin-left"))+parseInt(a.css("padding-left")))-t.find('[data-role="indicator"]').outerWidth(!0),t.css({position:"absolute",top:r,left:n,width:l.outerWidth(!0)}),"true"===l.attr("data-droppable")&&l.droppable("destroy"),gj.tree.plugins.dragAndDrop.private.getTargetDisplays(d,i,l).each(function(){var e=$(this);"true"===e.attr("data-droppable")&&e.droppable("destroy"),e.droppable()}),gj.tree.plugins.dragAndDrop.private.getTargetDisplays(d,i).each(function(){var e=$(this);"true"===e.attr("data-droppable")&&e.droppable("destroy"),e.droppable()}),t.trigger("mousedown"))}},getTargetDisplays:function(e,t,a){return e.find('[data-role="display"]').not(a).not(t.find('[data-role="display"]'))},getTargetWrappers:function(e,t){return e.find('[data-role="wrapper"]').not(t.find('[data-role="wrapper"]'))},createDragHandler:function(e,t,a){var d=gj.tree.plugins.dragAndDrop.private.getTargetDisplays(e,t,a),i=gj.tree.plugins.dragAndDrop.private.getTargetWrappers(e,t),l=e.data();return function(e,t,a){var r=$(this),n=!1;d.each(function(){var e;if($(this).droppable("isOver",a))return e=r.find('[data-role="indicator"]'),l.style.dropAsChildIcon?e.addClass(l.style.dropAsChildIcon):e.text("+"),!(n=!0);r.find('[data-role="indicator"]').removeClass(l.style.dropAsChildIcon).empty()}),i.each(function(){var e,t=$(this);!n&&t.droppable("isOver",a)?(e=t.position().top+t.outerHeight()/2,a.y<e?t.addClass(l.style.dropAbove).removeClass(l.style.dropBelow):t.addClass(l.style.dropBelow).removeClass(l.style.dropAbove)):t.removeClass(l.style.dropAbove).removeClass(l.style.dropBelow)})}},createDragStopHandler:function(o,s,e){var t=gj.tree.plugins.dragAndDrop.private.getTargetDisplays(o,s,e),p=gj.tree.plugins.dragAndDrop.private.getTargetWrappers(o,s),c=o.data();return function(e,n){var d,i,l,a,r=!1;$(this).draggable("destroy").remove(),t.each(function(){var e,t=$(this);if(t.droppable("isOver",n))return i=t.closest("li"),l=s.parent("ul").parent("li"),0===(e=i.children("ul")).length&&(e=$("<ul />").addClass(c.style.list),i.append(e)),!1!==gj.tree.plugins.dragAndDrop.events.nodeDrop(o,s.data("id"),i.data("id"),e.children("li").length+1)&&(e.append(s),d=o.getDataById(s.data("id")),gj.tree.methods.removeDataById(o,s.data("id"),c.records),void 0===(a=o.getDataById(e.parent().data("id")))[c.childrenField]&&(a[c.childrenField]=[]),a[c.childrenField].push(d),gj.tree.plugins.dragAndDrop.private.refresh(o,s,i,l)),!(r=!0);t.droppable("destroy")}),r||p.each(function(){var e,t,a,r=$(this);if(r.droppable("isOver",n))return i=r.closest("li"),l=s.parent("ul").parent("li"),e=n.y<r.position().top+r.outerHeight()/2,a=s.data("id"),t=i.prevAll('li:not([data-id="'+a+'"])').length+(e?1:2),!1!==gj.tree.plugins.dragAndDrop.events.nodeDrop(o,a,i.parent("ul").parent("li").data("id"),t)&&(d=o.getDataById(s.data("id")),gj.tree.methods.removeDataById(o,s.data("id"),c.records),o.getDataById(i.parent().data("id"))[c.childrenField].splice(i.index()+(e?0:1),0,d),e?s.insertBefore(i):s.insertAfter(i),gj.tree.plugins.dragAndDrop.private.refresh(o,s,i,l)),!1;r.droppable("destroy")})}},refresh:function(e,t,a,r){var n=e.data();gj.tree.plugins.dragAndDrop.private.refreshNode(e,a),gj.tree.plugins.dragAndDrop.private.refreshNode(e,r),gj.tree.plugins.dragAndDrop.private.refreshNode(e,t),t.find('li[data-role="node"]').each(function(){gj.tree.plugins.dragAndDrop.private.refreshNode(e,$(this))}),a.children('[data-role="wrapper"]').removeClass(n.style.dropAbove).removeClass(n.style.dropBelow)},refreshNode:function(e,t){var a=t.children('[data-role="wrapper"]'),r=a.children('[data-role="expander"]'),n=a.children('[data-role="spacer"]'),d=t.children("ul"),e=e.data(),t=t.parentsUntil('[data-type="tree"]',"ul").length;d.length&&d.children().length?d.is(":visible")?r.empty().append(e.icons.collapse):r.empty().append(e.icons.expand):r.empty(),a.removeClass(e.style.dropAbove).removeClass(e.style.dropBelow),n.css("width",e.indentation*(t-1))}},public:{},events:{nodeDrop:function(e,t,a,r){return e.triggerHandler("nodeDrop",[t,a,r])}},configure:function(a){$.extend(!0,a,gj.tree.plugins.dragAndDrop.public),a.data("dragAndDrop")&&gj.draggable&&gj.droppable&&a.on("nodeDataBound",function(e,t){gj.tree.plugins.dragAndDrop.private.nodeDataBound(a,t)})}},gj.tree.plugins.lazyLoading={config:{base:{paramNames:{parentId:"parentId"},lazyLoading:!1}},private:{nodeDataBound:function(e,t,a,r){e=e.data(),t=t.find('> [data-role="wrapper"] > [data-role="expander"]');r.hasChildren&&t.empty().append(e.icons.expand)},createDoneHandler:function(d,i){return function(e){var t,a,r,n=d.data();if((e="string"==typeof e&&JSON?JSON.parse(e):e)&&e.length){for(0===(r=i.children("ul")).length&&(r=$("<ul />").addClass(n.style.list),i.append(r)),t=0;t<e.length;t++)d.addNode(e[t],r);(a=i.find('>[data-role="wrapper"]>[data-role="expander"]')).attr("data-mode","open"),a.empty().append(n.icons.collapse),gj.tree.events.dataBound(d)}}},expand:function(e,t,a){var r=e.data(),n={},d=t.find(">ul>li");d&&d.length||"string"==typeof r.dataSource&&(n[r.paramNames.parentId]=a,d={url:r.dataSource,data:n},e.xhr&&e.xhr.abort(),e.xhr=$.ajax(d).done(gj.tree.plugins.lazyLoading.private.createDoneHandler(e,t)).fail(e.createErrorHandler()))}},public:{},events:{},configure:function(n,e,t){t.lazyLoading&&(n.on("nodeDataBound",function(e,t,a,r){gj.tree.plugins.lazyLoading.private.nodeDataBound(n,t,a,r)}),n.on("expand",function(e,t,a){gj.tree.plugins.lazyLoading.private.expand(n,t,a)}))}};