gj.tree={plugins:{}},gj.tree.config={base:{params:{},autoLoad:!0,selectionType:"single",cascadeSelection:!1,dataSource:void 0,primaryKey:void 0,textField:"text",childrenField:"children",hasChildrenField:"hasChildren",imageCssClassField:"imageCssClass",imageUrlField:"imageUrl",imageHtmlField:"imageHtml",disabledField:"disabled",width:void 0,border:!1,uiLibrary:"materialdesign",iconsLibrary:"materialicons",autoGenId:1,autoGenFieldName:"autoId_b5497cc5-7ef3-49f5-a7dc-4a932e1aee4a",indentation:24,style:{wrapper:"gj-unselectable",list:"gj-list gj-list-md",item:void 0,active:"gj-list-md-active",leafIcon:void 0,border:"gj-tree-md-border"},icons:{expand:'<i class="gj-icon chevron-right" />',collapse:'<i class="gj-icon chevron-down" />'}},bootstrap:{style:{wrapper:"gj-unselectable gj-tree-bootstrap-3",list:"gj-list gj-list-bootstrap list-group",item:"list-group-item",active:"active",border:"gj-tree-bootstrap-border"},iconsLibrary:"glyphicons"},bootstrap4:{style:{wrapper:"gj-unselectable gj-tree-bootstrap-4",list:"gj-list gj-list-bootstrap",item:"list-group-item",active:"active",border:"gj-tree-bootstrap-border"},icons:{expand:'<i class="gj-icon plus" />',collapse:'<i class="gj-icon minus" />'}},materialicons:{style:{expander:"gj-tree-material-icons-expander"}},fontawesome:{style:{expander:"gj-tree-font-awesome-expander"},icons:{expand:'<i class="fa fa-plus" aria-hidden="true"></i>',collapse:'<i class="fa fa-minus" aria-hidden="true"></i>'}},glyphicons:{style:{expander:"gj-tree-glyphicons-expander"},icons:{expand:'<span class="glyphicon glyphicon-plus" />',collapse:'<span class="glyphicon glyphicon-minus" />'}}},gj.tree.events={initialized:function(e){e.triggerHandler("initialized")},dataBinding:function(e){e.triggerHandler("dataBinding")},dataBound:function(e){e.triggerHandler("dataBound")},select:function(e,t,r){return e.triggerHandler("select",[t,r])},unselect:function(e,t,r){return e.triggerHandler("unselect",[t,r])},expand:function(e,t,r){return e.triggerHandler("expand",[t,r])},collapse:function(e,t,r){return e.triggerHandler("collapse",[t,r])},enable:function(e,t){return e.triggerHandler("enable",[t])},disable:function(e,t){return e.triggerHandler("disable",[t])},destroying:function(e){return e.triggerHandler("destroying")},nodeDataBound:function(e,t,r,a){return e.triggerHandler("nodeDataBound",[t,r,a])}},gj.tree.methods={init:function(e){return gj.widget.prototype.init.call(this,e),gj.tree.methods.initialize.call(this),this.getConfig().autoLoad&&this.reload(),this},initialize:function(){var e=this.getConfig(),t=this.wrap("div");gj.core.addClasses(this.element,e.style.list),gj.core.addClasses(t,e.style.wrapper),e.width&&this.width(e.width),e.border&&gj.core.addClasses(t,e.style.border),gj.tree.events.initialized(this.element)},useHtmlDataSource:function(e,t){t.dataSource=[]},render:function(e,t){var r;return t&&("string"==typeof t&&JSON&&(t=JSON.parse(t)),r=e.getConfig(),e.setRecords(t),r.primaryKey||gj.tree.methods.genAutoId(r,t),gj.tree.methods.loadData(e)),e},filter:function(e){return e.getConfig().dataSource},genAutoId:function(e,t){let r;for(r=0;r<t.length;r++)t[r][e.autoGenFieldName]=e.autoGenId++,t[r][e.childrenField]&&t[r][e.childrenField].length&&gj.tree.methods.genAutoId(e,t[r][e.childrenField])},loadData:function(e){let t,r=e.getRecords();for(gj.tree.events.dataBinding(e),e.element.innerHTML="",t=0;t<r.length;t++)gj.tree.methods.appendNode(e,e.element,r[t],1);gj.tree.events.dataBound(e.element)},appendNode:function(e,t,r,a,n){let d,l,i,o,s,c,g,p,u,h=e.getConfig(),f=h.primaryKey?r[h.primaryKey]:r[h.autoGenFieldName],j=void 0!==r[h.hasChildrenField]&&"true"===r[h.hasChildrenField].toString().toLowerCase(),b=void 0!==r[h.disabledField]&&"true"===r[h.disabledField].toString().toLowerCase();if((l=document.createElement("li")).setAttribute("data-gj-id",f),l.setAttribute("data-gj-role","node"),gj.core.addClasses(l,h.style.item),(i=document.createElement("div")).setAttribute("data-gj-role","wrapper"),(o=document.createElement("span")).setAttribute("data-gj-role","expander"),o.setAttribute("data-gj-mode","close"),gj.core.addClasses(o,h.style.expander),(s=document.createElement("span")).setAttribute("data-gj-role","display"),s.innerHTML=r[h.textField],h.indentation&&((c=document.createElement("span")).setAttribute("data-gj-role","spacer"),c.style.width=h.indentation*(a-1)/16+"rem",i.appendChild(c)),b?gj.tree.methods.disableNode(e,l):(o.addEventListener("click",gj.tree.methods.expanderClickHandler(e)),s.addEventListener("click",gj.tree.methods.displayClickHandler(e))),i.appendChild(o),i.appendChild(s),l.appendChild(i),n?t.insertBefore(l,t.children[n-1]):t.appendChild(l),h.imageCssClassField&&r[h.imageCssClassField]?((p=document.createElement("span")).setAttribute("data-gj-role","image"),p.innerHTML='<span class="'+r[h.imageCssClassField]+'"></span>',i.insertBefore(p,s)):h.imageUrlField&&r[h.imageUrlField]?((p=document.createElement("span")).setAttribute("data-gj-role","image"),i.insertBefore(p,s),(u=document.createElement("img")).setAttribute("src",r[h.imageUrlField]),u.setAttribute("width",gj.core.width(p)),u.setAttribute("height",gj.core.height(p)),p.appendChild(u)):h.imageHtmlField&&r[h.imageHtmlField]&&((p=document.createElement("span")).setAttribute("data-gj-role","image"),p.innerHTML=r[h.imageHtmlField],i.insertBefore(p,s)),r[h.childrenField]&&r[h.childrenField].length||j){if(o.innerHTML=h.icons.expand,g=document.createElement("ul"),gj.core.addClasses(g,h.style.list+" gj-hidden"),l.appendChild(g),r[h.childrenField]&&r[h.childrenField].length)for(d=0;d<r[h.childrenField].length;d++)gj.tree.methods.appendNode(e,g,r[h.childrenField][d],a+1)}else h.style.leafIcon?gj.core.addClasses(o,h.style.leafIcon):o.innerHTML="&nbsp;";gj.tree.events.nodeDataBound(e.element,l,r.id,r)},expanderClickHandler:function(r){return function(e){var t=this.closest("li");"close"===this.getAttribute("data-gj-mode")?r.expand(t):r.collapse(t)}},expand:function(e,t,r){let a,n,d=t.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="expander"]'),l=e.getConfig(),i=t.getAttribute("data-gj-id"),o=t.querySelector(">ul");if(!1!==gj.tree.events.expand(e.element,t,i)&&o&&o.length&&(o.style.display="block",d.setAttribute("data-gj-mode","open"),d.innerHTML=l.icons.collapse,r))for(a=t.querySelector(">ul>li"),n=0;n<a.length;n++)gj.tree.methods.expand(e,a[n],r);return e},collapse:function(e,t,r){let a,n,d=t.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="expander"]'),l=e.getConfig(),i=t.getAttribute("data-gj-id"),o=t.children("ul");if(!1!==gj.tree.events.collapse(e,t,i)&&o&&o.length&&(o.style.display="none",d.setAttribute("data-gj-mode","close"),d.innerHTML=l.icons.expand,r))for(a=t.find('>ul>li>[data-gj-role="wrapper"]>span[data-gj-mode="open"]'),n=0;n<a.length;n++)gj.tree.methods.collapse(e,a[n],r);return e},expandAll:function(e){let t,r=e.find("ul>li");for(t=0;t<r.length;t++)gj.tree.methods.expand(e,$(r[t]),!0);return e},collapseAll:function(e){let t,r=e.querySelectorAll('>ul>li>[data-gj-role="wrapper"]>span[data-gj-mode="open"]');for(t=0;t<r.length;t++)gj.tree.methods.collapse(e,r[t],!0);return e},displayClickHandler:function(r){return function(){var e=this.closest("li"),t=r.getConfig();cascade=t.cascadeSelection,"true"===e.getAttribute("data-gj-selected")?gj.tree.methods.unselect(r,e,cascade):("single"===t.selectionType&&gj.tree.methods.unselectAll(r),gj.tree.methods.select(r,e,cascade))}},selectAll:function(e){let t,r=e.querySelectorAll("ul>li");for(t=0;t<r.length;t++)gj.tree.methods.select(e,r[t],!0);return e},select:function(e,t,r){let a,n,d=e.getConfig();if("true"!==t.getAttribute("data-gj-selected")&&!1!==gj.tree.events.select(e,t,t.getAttribute("data-gj-id"))&&(t.addClass(d.style.active).attr("data-gj-selected","true"),r))for(n=t.querySelectorAll("ul>li"),a=0;a<n.length;a++)gj.tree.methods.select(e,$(n[a]),r)},unselectAll:function(e){let t,r=e.querySelectorAll(">ul>li");for(t=0;t<r.length;t++)gj.tree.methods.unselect(e,r[t],!0);return e},unselect:function(e,t,r){let a,n,d=e.getConfig();if("true"===t.getAttribute("data-gj-selected")&&!1!==gj.tree.events.unselect(e,t,t.getAttribute("data-gj-id"))&&(gj.core.removeClasses(t,d.style.active),t.removeAttribute("data-gj-selected"),r))for(n=t.querySelectorAll(">ul>li"),a=0;a<n.length;a++)gj.tree.methods.unselect(e,n[a],r)},getSelections:function(e){let t,r,a,n=[],d=e.children;if(d&&d.length)for(t=0;t<d.length;t++)"true"===(r=$(d[t])).getAttribute("data-gj-selected")?n.push(r.getAttribute("data-gj-id")):r.has("ul")&&(a=gj.tree.methods.getSelections(r.querySelector(">ul"))).length&&(n=n.concat(a));return n},getDataById:function(e,t,r){let a,n=e.getConfig(),d=void 0;for(a=0;a<r.length;a++){if(n.primaryKey&&r[a][n.primaryKey]==t){d=r[a];break}if(r[a][n.autoGenFieldName]==t){d=r[a];break}if(r[a][n.childrenField]&&r[a][n.childrenField].length&&(d=gj.tree.methods.getDataById(e,t,r[a][n.childrenField])))break}return d},getDataByText:function(e,t,r){let a,n=void 0,d=e.getConfig();for(a=0;a<r.length;a++){if(t===r[a][d.textField]){n=r[a];break}if(r[a][d.childrenField]&&r[a][d.childrenField].length&&(n=gj.tree.methods.getDataByText(e,t,r[a][d.childrenField])))break}return n},getNodeById:function(e,t){let r,a,n=void 0,d=e.children("li");if(d&&d.length)for(r=0;r<d.length;r++){if(t==(a=$(d[r])).getAttribute("data-gj-id")){n=a;break}if(a.has("ul")&&(n=gj.tree.methods.getNodeById(a.querySelector(">ul"),t)))break}return n},getNodeByText:function(e,t){let r,a,n=void 0,d=e.children("li");if(d&&d.length)for(r=0;r<d.length;r++){if(t===(a=$(d[r])).querySelector('>[data-gj-role="wrapper"]>[data-gj-role="display"]').innerText){n=a;break}if(a.has("ul")&&(n=gj.tree.methods.getNodeByText(a.querySelector(">ul"),t)))break}return n},addNode:function(e,t,r,a){var n,d=e.getConfig();return r&&r.length?("li"===r[0].tagName.toLowerCase()&&(0===r.querySelectorAll(">ul").length&&(r.querySelector('[data-gj-role="expander"]').innerHTML=d.icons.collapse,r.appendChild(gj.core.addClasses(document.createElement("ul"),d.style.list))),r=r.querySelector(">ul")),(n=e.getDataById(r.parentNode.getAttribute("data-gj-id")))[d.childrenField]||(n[d.childrenField]=[]),n[d.childrenField].push(t)):(r=e.children("ul"),e.setRecords(e.getRecords().push(t))),n=gj.tree.getLevel(r),d.primaryKey||gj.tree.methods.genAutoId(d,[t]),gj.tree.methods.appendNode(e,r,t,n,a),e},getLevel:function(e){let t=1,r=e.parentNode;for(;r&&"tree"!==r.getAttribute("data-gj-type");)t++,r=r.parentNode},remove:function(e,t){return gj.tree.methods.removeDataById(e,t.getAttribute("data-gj-id"),e.getRecords()),t.remove(),e},removeDataById:function(e,t,r){let a,n=e.getConfig();for(a=0;a<r.length;a++){if(n.primaryKey&&r[a][n.primaryKey]==t){r.splice(a,1);break}if(r[a][n.autoGenFieldName]==t){r.splice(a,1);break}r[a][n.childrenField]&&r[a][n.childrenField].length&&gj.tree.methods.removeDataById(e,t,r[a][n.childrenField])}},update:function(e,t,r){var a=e.getConfig(),n=e.getNodeById(t);e.getDataById(t);return n.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="display"]').innerHTML=r[a.textField],gj.tree.events.nodeDataBound(e.element,n,t,r),e},getChildren:function(e,t,r){let a=[],n,d,r=void 0===r||r;for(d=r?t.querySelectorAll("ul li"):t.querySelectorAll(">ul>li"),n=0;n<d.length;n++)a.push(d[n].getAttribute("data-gj-id"));return a},enableAll:function(e){let t,r=e.querySelectorAll("ul>li");for(t=0;t<r.length;t++)gj.tree.methods.enableNode(e,r[t],!0);return e},enableNode:function(e,t,r){let a,n,d=t.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="expander"]'),l=t.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="display"]'),r=void 0===r||r;if(t.classList.remove("disabled"),d.addEventListener("click",gj.tree.methods.expanderClickHandler(e)),l.addEventListener("click",gj.tree.methods.displayClickHandler(e)),gj.tree.events.enable(e,t),r)for(n=t.querySelectorAll("ul>li"),a=0;a<n.length;a++)gj.tree.methods.enableNode(e,n[a],r)},disableAll:function(e){let t,r=e.querySelectorAll("ul>li");for(t=0;t<r.length;t++)gj.tree.methods.disableNode(e,r[t],!0);return e},disableNode:function(e,t,r){let a,n,r=(t.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="expander"]'),t.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="display"]'),void 0===r||r);if(t.classList.add("disabled"),gj.tree.events.disable(e.element,t),r)for(n=t.querySelectorAll("ul>li"),a=0;a<n.length;a++)gj.tree.methods.disableNode(e,n[a],r)},destroy:function(e){return e.getConfig()&&(gj.tree.events.destroying(e.element),e.xhr&&e.xhr.abort(),e.removeData(),e.removeAttribute("data-gj-type"),e.removeClass(),e.innerHTML=""),e},pathFinder:function(e,t,r,a){let n,d=!1;for(n=0;n<t.length;n++){if(t[n].id==r){d=!0;break}if(gj.tree.methods.pathFinder(e,t[n][e.childrenField],r,a)){a.push(t[n].data[e.textField]),d=!0;break}}return d}},(GijgoTree=function(e,t){var r=this,a=gj.datepicker.methods;return r.type="tree",r.element=e,r.reload=function(e){return gj.widget.prototype.reload.call(this,e)},r.render=function(e){return a.render(this,e)},r.addNode=function(e,t,r){return a.addNode(this,e,t,r)},r.removeNode=function(e){return a.remove(this,e)},r.updateNode=function(e,t){return a.update(this,e,t)},r.destroy=function(){return a.destroy(this)},r.expand=function(e,t){return a.expand(this,e,t)},r.collapse=function(e,t){return a.collapse(this,e,t)},r.expandAll=function(){return a.expandAll(this)},r.collapseAll=function(){return a.collapseAll(this)},r.getDataById=function(e){return a.getDataById(this,e,this.data("records"))},r.getDataByText=function(e){return a.getDataByText(this,e,this.data("records"))},r.getNodeById=function(e){return a.getNodeById(this.children("ul"),e)},r.getNodeByText=function(e){return a.getNodeByText(this.children("ul"),e)},r.getAll=function(){return this.data("records")},r.select=function(e){return a.select(this,e)},r.unselect=function(e){return a.unselect(this,e)},r.selectAll=function(){return a.selectAll(this)},r.unselectAll=function(){return a.unselectAll(this)},r.getSelections=function(){return a.getSelections(this.children("ul"))},r.getChildren=function(e,t){return a.getChildren(this,e,t)},r.parents=function(e){var t=[],r=this.data();return a.pathFinder(r,r.records,e,t),t.reverse()},r.enable=function(e,t){return a.enableNode(this,e,t)},r.enableAll=function(){return a.enableAll(this)},r.disable=function(e,t){return a.disableNode(this,e,t)},r.disableAll=function(){return a.disableAll(this)},"tree"!==e.attr("data-type")&&a.init.call(r,t),r}).prototype=new gj.widget,GijgoTree.constructor=gj.tree.widget,"undefined"!=typeof jQuery&&(jQuery.fn.tree=function(e){var t;if(this&&this.length){if("object"!=typeof e&&e){if((t=new GijgoTree(this,null))[e])return t[e].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+e+" does not exist."}return new GijgoTree(this,e)}}),gj.tree.plugins.checkboxes={config:{base:{checkboxes:void 0,checkedField:"checked",cascadeCheck:!0}},private:{dataBound:function(e){if(e.data("cascadeCheck"))for(const r of e.find('li[data-gj-role="node"]')){var t=gj.checkbox.methods.state(r.querySelector('[data-gj-role="checkbox"] input[type="checkbox"]'));"checked"===t&&(gj.tree.plugins.checkboxes.private.updateChildrenState(r,t),gj.tree.plugins.checkboxes.private.updateParentState(r,t))}},nodeDataBound:function(t,r,e,a){let n,d,l,i;r.querySelector('> [data-gj-role="wrapper"] > [data-gj-role="checkbox"]')&&(n=t.getConfig(),d=r.querySelector('> [data-gj-role="wrapper"] > [data-gj-role="expander"]'),(l=document.createElement("input")).setAttribute("type","checkbox"),i=void 0!==a[n.disabledField]&&"true"===a[n.disabledField].toString().toLowerCase(),l=new GijgoCheckBox(l,{uiLibrary:n.uiLibrary,iconsLibrary:n.iconsLibrary,change:function(e){gj.tree.plugins.checkboxes.events.checkboxChange(t.element,r,a,e.detail.state)}}),i&&(l.disabled=!0),a[n.checkedField]&&l.state("checked"),l.on("click",function(e){var t=l.closest("li"),r=l.state();n.cascadeCheck&&(gj.tree.plugins.checkboxes.private.updateChildrenState(t,r),gj.tree.plugins.checkboxes.private.updateParentState(t,r))}),d.parentNode.insertBefore(void 0,d.nextSubling))},updateParentState:function(e,t){let r,a,n,d,l,i;if(r=e.parentNode.parentNode){a=r.querySelector('> [data-gj-role="wrapper"] > [data-gj-role="checkbox"] input[type="checkbox"]'),n=e.parentNode.querySelectorAll('> [data-gj-role="wrapper"] > span[data-gj-role="checkbox"] input[type="checkbox"]'),d="checked"===t,l="unchecked"===t,i="indeterminate";for(const s of n){var o=gj.checkbox.methods.state(s);d&&"checked"!==o&&(d=!1),l&&"unchecked"!==o&&(l=!1)}d&&!l&&(i="checked"),!d&&l&&(i="unchecked"),gj.checkbox.methods.state(a,i),gj.tree.plugins.checkboxes.private.updateParentState(r,i)}},updateChildrenState:function(e,t){for(const r of e.querySelectorAll('ul li [data-gj-role="wrapper"] [data-gj-role="checkbox"] input[type="checkbox"]'))gj.checkbox.methods.state(r,t)},update:function(e,t,r){var a=t.querySelector('[data-gj-role="checkbox"] input[type="checkbox"]');gj.checkbox.methods.state(a,r),e.getConfig().cascadeCheck&&(gj.tree.plugins.checkboxes.private.updateChildrenState(t,r),gj.tree.plugins.checkboxes.private.updateParentState(t,r))}},public:{getCheckedNodes:function(){var e=[];for(const t of this.element.querySelectorAll('li [data-gj-role="checkbox"] input[type="checkbox"]'))"checked"===gj.checkbox.methods.state(t)&&e.push(t.closest("li").getAttribute("data-gj-id"));return e},checkAll:function(){for(const e of this.element.querySelectorAll('li [data-gj-role="checkbox"] input[type="checkbox"]'))gj.checkbox.methods.state(e,"checked");return this},uncheckAll:function(){for(const e of this.element.querySelectorAll('li [data-gj-role="checkbox"] input[type="checkbox"]'))gj.checkbox.methods.state(e,"unchecked");return this},check:function(e){return gj.tree.plugins.checkboxes.private.update(this,e,"checked"),this},uncheck:function(e){return gj.tree.plugins.checkboxes.private.update(this,e,"unchecked"),this}},events:{checkboxChange:function(e,t,r,a){return e.dispatchEvent(new CustomEvent("checkboxChange",{detail:{node:t,record:r,state:a}}))}},configure:function(n){n.getConfig().checkboxes&&gj.checkbox&&(this.extend(n,gj.tree.plugins.checkboxes.public),n.on("nodeDataBound",function(e,t,r,a){gj.tree.plugins.checkboxes.private.nodeDataBound(n,t,r,a)}),n.on("dataBound",function(){gj.tree.plugins.checkboxes.private.dataBound(n)}),n.on("enable",function(e,t){for(const r of t.querySelectorAll('>[data-gj-role="wrapper"]>[data-gj-role="checkbox"] input[type="checkbox"]'))r.disabled=!1}),n.on("disable",function(e,t){for(const r of t.querySelectorAll('>[data-gj-role="wrapper"]>[data-gj-role="checkbox"] input[type="checkbox"]'))r.disabled=!0}))}},gj.tree.plugins.dragAndDrop={config:{base:{dragAndDrop:void 0,style:{dragEl:"gj-tree-drag-el gj-tree-md-drag-el",dropAsChildIcon:"gj-cursor-pointer gj-icon plus",dropAbove:"gj-tree-drop-above",dropBelow:"gj-tree-drop-below"}},bootstrap:{style:{dragEl:"gj-tree-drag-el gj-tree-bootstrap-drag-el",dropAsChildIcon:"glyphicon glyphicon-plus",dropAbove:"drop-above",dropBelow:"drop-below"}},bootstrap4:{style:{dragEl:"gj-tree-drag-el gj-tree-bootstrap-drag-el",dropAsChildIcon:"gj-cursor-pointer gj-icon plus",dropAbove:"drop-above",dropBelow:"drop-below"}}},private:{nodeDataBound:function(e,t){var r=t.querySelector('>[data-gj-role="wrapper"]'),a=t.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="display"]');r&&a&&(a.addEventListener("mousedown",gj.tree.plugins.dragAndDrop.private.createNodeMouseDownHandler(e)),a.addEventListener("mousemove",gj.tree.plugins.dragAndDrop.private.createNodeMouseMoveHandler(e,t,a)),a.addEventListener("mouseup",gj.tree.plugins.dragAndDrop.private.createNodeMouseUpHandler(e)))},createNodeMouseDownHandler:function(t){return function(e){t.element.setAttribute("data-gj-drag-ready",!0)}},createNodeMouseUpHandler:function(t){return function(e){t.element.setAttribute("data-gj-drag-ready",!1)}},createNodeMouseMoveHandler:function(i,o,s){return function(e){if("true"===i.element.getAttribute("data-gj-drag-ready")){let e=i.getConfig(),t,r,a,n,d,l;i.element.setAttribute("data-gj-drag-ready",!1),(t=s.cloneNode()).setAttribute("data-gj-role","draggable-clone"),t.classList.add("gj-unselectable"),gj.core.addClasses(t,e.style.dragEl),r=gj.core.wrap(t,"div"),a=document.createElement("ul"),gj.core.addClasses(a,e.style.list),r.appendChild(a),n=document.createElement("li"),gj.core.addClasses(n,e.style.item),a.appendChild(n),document.body.appendChild(t),t.find('[data-gj-role="wrapper"]').prepend('<span data-gj-role="indicator" />'),new GijgoDraggable(t,{drag:gj.tree.plugins.dragAndDrop.private.createDragHandler(i,o,s),stop:gj.tree.plugins.dragAndDrop.private.createDragStopHandler(i,o,s)}),r=s.parent(),d=s.offset().top,d-=parseInt(r.css("border-top-width"))+parseInt(r.css("margin-top"))+parseInt(r.css("padding-top")),l=s.offset().left,l=(l-=parseInt(r.css("border-left-width"))+parseInt(r.css("margin-left"))+parseInt(r.css("padding-left")))-t.find('[data-gj-role="indicator"]').outerWidth(!0),t.css({position:"absolute",top:d,left:l,width:s.outerWidth(!0)}),"true"===s.attr("data-droppable")&&s.droppable("destroy"),gj.tree.plugins.dragAndDrop.private.getTargetDisplays(i,o,s).each(function(){"true"===this.attr("data-droppable")&&this.droppable("destroy"),this.droppable()}),gj.tree.plugins.dragAndDrop.private.getTargetDisplays(i,o).each(function(){"true"===this.attr("data-droppable")&&this.droppable("destroy"),this.droppable()}),t.trigger("mousedown")}}},getTargetDisplays:function(e,t,r){return e.find('[data-gj-role="display"]').not(r).not(t.find('[data-gj-role="display"]'))},getTargetWrappers:function(e,t){return e.find('[data-gj-role="wrapper"]').not(t.find('[data-gj-role="wrapper"]'))},createDragHandler:function(e,t,r){let d=gj.tree.plugins.dragAndDrop.private.getTargetDisplays(e,t,r),l=gj.tree.plugins.dragAndDrop.private.getTargetWrappers(e,t),i=e.getConfig();return function(e,t,r){let a=this,n=!1;d.each(function(){var e;if(this.droppable("isOver",r))return e=a.find('[data-gj-role="indicator"]'),i.style.dropAsChildIcon?e.addClass(i.style.dropAsChildIcon):e.text("+"),!(n=!0);a.find('[data-gj-role="indicator"]').removeClass(i.style.dropAsChildIcon).empty()}),l.each(function(){var e,t=this;!n&&t.droppable("isOver",r)?(e=t.position().top+t.outerHeight()/2,r.y<e?t.addClass(i.style.dropAbove).removeClass(i.style.dropBelow):t.addClass(i.style.dropBelow).removeClass(i.style.dropAbove)):t.removeClass(i.style.dropAbove).removeClass(i.style.dropBelow)})}},createDragStopHandler:function(o,s,e){let a=gj.tree.plugins.dragAndDrop.private.getTargetDisplays(o,s,e),c=gj.tree.plugins.dragAndDrop.private.getTargetWrappers(o,s),g=o.getConfig();return function(e,n){let t=!1,d,l,i,r;this.draggable("destroy").remove(),a.each(function(){let e;if(this.droppable("isOver",n))return l=this.closest("li"),i=s.parent("ul").parent("li"),0===(e=l.children("ul")).length&&(e="<ul />".addClass(g.style.list),l.append(e)),!1!==gj.tree.plugins.dragAndDrop.events.nodeDrop(o,s.data("id"),l.data("id"),e.children("li").length+1)&&(e.append(s),d=o.getDataById(s.data("id")),gj.tree.methods.removeDataById(o,s.data("id"),g.records),void 0===(r=o.getDataById(e.parent().data("id")))[g.childrenField]&&(r[g.childrenField]=[]),r[g.childrenField].push(d),gj.tree.plugins.dragAndDrop.private.refresh(o,s,l,i)),!(t=!0);this.droppable("destroy")}),t||c.each(function(){var e,t,r,a=this;if(a.droppable("isOver",n))return l=a.closest("li"),i=s.parent("ul").parent("li"),e=n.y<a.position().top+a.outerHeight()/2,r=s.data("id"),t=l.prevAll('li:not([data-id="'+r+'"])').length+(e?1:2),!1!==gj.tree.plugins.dragAndDrop.events.nodeDrop(o,r,l.parent("ul").parent("li").data("id"),t)&&(d=o.getDataById(s.data("id")),gj.tree.methods.removeDataById(o,s.data("id"),g.records),o.getDataById(l.parent().data("id"))[g.childrenField].splice(l.index()+(e?0:1),0,d),e?s.insertBefore(l):s.insertAfter(l),gj.tree.plugins.dragAndDrop.private.refresh(o,s,l,i)),!1;a.droppable("destroy")})}},refresh:function(e,t,r,a){var n=e.getConfig();gj.tree.plugins.dragAndDrop.private.refreshNode(e,r),gj.tree.plugins.dragAndDrop.private.refreshNode(e,a),gj.tree.plugins.dragAndDrop.private.refreshNode(e,t),t.find('li[data-gj-role="node"]').each(function(){gj.tree.plugins.dragAndDrop.private.refreshNode(e,this)}),r.children('[data-gj-role="wrapper"]').removeClass(n.style.dropAbove).removeClass(n.style.dropBelow)},refreshNode:function(e,t){var r=t.children('[data-gj-role="wrapper"]'),a=r.children('[data-gj-role="expander"]'),n=r.children('[data-gj-role="spacer"]'),d=t.children("ul"),e=e.getConfig(),t=t.parentsUntil('[data-type="tree"]',"ul").length;d.length&&d.children().length?d.is(":visible")?a.empty().append(e.icons.collapse):a.empty().append(e.icons.expand):a.empty(),r.removeClass(e.style.dropAbove).removeClass(e.style.dropBelow),n.css("width",e.indentation*(t-1))}},public:{},events:{nodeDrop:function(e,t,r,a){return e.triggerHandler("nodeDrop",[t,r,a])}},configure:function(r){r.extend(r,gj.tree.plugins.dragAndDrop.public),r.data("dragAndDrop")&&gj.draggable&&gj.droppable&&r.on("nodeDataBound",function(e,t){gj.tree.plugins.dragAndDrop.private.nodeDataBound(r,t)})}},gj.tree.plugins.lazyLoading={config:{base:{paramNames:{parentId:"parentId"},lazyLoading:!1}},private:{nodeDataBound:function(e,t,r,a){e=e.getConfig(),t=t.querySelector('> [data-gj-role="wrapper"] > [data-gj-role="expander"]');a.hasChildren&&(t.innerHTML=e.icons.expand)},createDoneHandler:function(d,l){return function(e){let t,r,a,n=d.getConfig();if((e="string"==typeof e&&JSON?JSON.parse(e):e)&&e.length){for(0===(a=l.children("ul")).length&&(a=document.createElement("ul"),gj.core.addClasses(a,n.style.list),l.appendChild(a)),t=0;t<e.length;t++)d.addNode(e[t],a);(r=l.querySelector('>[data-gj-role="wrapper"]>[data-gj-role="expander"]')).setAttribute("data-gj-mode","open"),r.innerHTML=n.icons.collapse,gj.tree.events.dataBound(d.element)}}},expand:function(e,t,r){var a=e.getConfig(),n={},d=t.querySelectorAll(">ul>li");d&&d.length||"string"==typeof a.dataSource&&(n[a.paramNames.parentId]=r,d={url:a.dataSource,data:n},e.xhr&&e.xhr.abort(),e.xhr=$.ajax(d).done(gj.tree.plugins.lazyLoading.private.createDoneHandler(e,t)).fail(e.createErrorHandler()))}},public:{},events:{},configure:function(t,e,r){r.lazyLoading&&(t.on("nodeDataBound",function(e){gj.tree.plugins.lazyLoading.private.nodeDataBound(t,e.detail.node,e.detail.id,e.detail.record)}),t.on("expand",function(e){gj.tree.plugins.lazyLoading.private.expand(t,e.detail.node,e.detail.id)}))}};